(function(d,c,a,e){var b=function(f){this._core=f;this._videos={};this._playing=null;this._handlers={"initialized.owl.carousel":d.proxy(function(g){if(g.namespace){this._core.register({type:"state",name:"playing",tags:["interacting"]})}},this),"resize.owl.carousel":d.proxy(function(g){if(g.namespace&&this._core.settings.video&&this.isInFullScreen()){g.preventDefault()}},this),"refreshed.owl.carousel":d.proxy(function(g){if(g.namespace&&this._core.is("resizing")){this._core.$stage.find(".cloned .owl-video-frame").remove()}},this),"changed.owl.carousel":d.proxy(function(g){if(g.namespace&&g.property.name==="position"&&this._playing){this.stop()}},this),"prepared.owl.carousel":d.proxy(function(h){if(!h.namespace){return}var g=d(h.content).find(".owl-video");if(g.length){g.css("display","none");this.fetch(g,d(h.content))}},this)};this._core.options=d.extend({},b.Defaults,this._core.options);this._core.$element.on(this._handlers);this._core.$element.on("click.owl.video",".owl-video-play-icon",d.proxy(function(g){this.play(g)},this))};b.Defaults={video:false,videoHeight:false,videoWidth:false};b.prototype.fetch=function(k,j){var i=(function(){if(k.attr("data-vimeo-id")){return"vimeo"}else{if(k.attr("data-vzaar-id")){return"vzaar"}else{return"youtube"}}})(),l=k.attr("data-vimeo-id")||k.attr("data-youtube-id")||k.attr("data-vzaar-id"),h=k.attr("data-width")||this._core.settings.videoWidth,f=k.attr("data-height")||this._core.settings.videoHeight,g=k.attr("href");if(g){l=g.match(/(http:|https:|)\/\/(player.|www.|app.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com|be\-nocookie\.com)|vzaar\.com)\/(video\/|videos\/|embed\/|channels\/.+\/|groups\/.+\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/);if(l[3].indexOf("youtu")>-1){i="youtube"}else{if(l[3].indexOf("vimeo")>-1){i="vimeo"}else{if(l[3].indexOf("vzaar")>-1){i="vzaar"}else{throw new Error("Video URL not supported.")}}}l=l[6]}else{throw new Error("Missing video URL.")}this._videos[g]={type:i,id:l,width:h,height:f};j.attr("data-video",g);this.thumbnail(k,this._videos[g])};b.prototype.thumbnail=function(l,h){var g,n,p,f=h.width&&h.height?"width:"+h.width+"px;height:"+h.height+"px;":"",m=l.find("img"),o="src",k="",i=this._core.settings,j=function(q){n='<div class="owl-video-play-icon"></div>';if(i.lazyLoad){g=d("<div/>",{"class":"owl-video-tn "+k,srcType:q})}else{g=d("<div/>",{"class":"owl-video-tn",style:"opacity:1;background-image:url("+q+")"})}l.after(g);l.after(n)};l.wrap(d("<div/>",{"class":"owl-video-wrapper",style:f}));if(this._core.settings.lazyLoad){o="data-src";k="owl-lazy"}if(m.length){j(m.attr(o));m.remove();return false}if(h.type==="youtube"){p="//img.youtube.com/vi/"+h.id+"/hqdefault.jpg";j(p)}else{if(h.type==="vimeo"){d.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+h.id+".json",jsonp:"callback",dataType:"jsonp",success:function(q){p=q[0].thumbnail_large;j(p)}})}else{if(h.type==="vzaar"){d.ajax({type:"GET",url:"//vzaar.com/api/videos/"+h.id+".json",jsonp:"callback",dataType:"jsonp",success:function(q){p=q.framegrab_url;j(p)}})}}}};b.prototype.stop=function(){this._core.trigger("stop",null,"video");this._playing.find(".owl-video-frame").remove();this._playing.removeClass("owl-video-playing");this._playing=null;this._core.leave("playing");this._core.trigger("stopped",null,"video")};b.prototype.play=function(l){var m=d(l.target),k=m.closest("."+this._core.settings.itemClass),j=this._videos[k.attr("data-video")],i=j.width||"100%",f=j.height||this._core.$stage.height(),g,h;if(this._playing){return}this._core.enter("playing");this._core.trigger("play",null,"video");k=this._core.items(this._core.relative(k.index()));this._core.reset(k.index());g=d('<iframe frameborder="0" allowfullscreen mozallowfullscreen webkitAllowFullScreen ></iframe>');g.attr("height",f);g.attr("width",i);if(j.type==="youtube"){g.attr("src","//www.youtube.com/embed/"+j.id+"?autoplay=1&rel=0&v="+j.id)}else{if(j.type==="vimeo"){g.attr("src","//player.vimeo.com/video/"+j.id+"?autoplay=1")}else{if(j.type==="vzaar"){g.attr("src","//view.vzaar.com/"+j.id+"/player?autoplay=true")}}}h=d(g).wrap('<div class="owl-video-frame" />').insertAfter(k.find(".owl-video"));this._playing=k.addClass("owl-video-playing")};b.prototype.isInFullScreen=function(){var f=a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement;return f&&d(f).parent().hasClass("owl-video-frame")};b.prototype.destroy=function(){var f,g;this._core.$element.off("click.owl.video");for(f in this._handlers){this._core.$element.off(f,this._handlers[f])}for(g in Object.getOwnPropertyNames(this)){typeof this[g]!="function"&&(this[g]=null)}};d.fn.owlCarousel.Constructor.Plugins.Video=b})(window.Zepto||window.jQuery,window,document);